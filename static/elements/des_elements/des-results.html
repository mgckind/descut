<dom-module id="des-results">
<template>
    <style>
    </style>


    <iron-ajax id="getTiles"
        auto
        url=/static/uploads/{{username}}/results/{{jobid}}/list.json
        handle-as="json"
        last-response="{{jsondata}}"
        on-response="_getTilesResponse">
    </iron-ajax>

    <des-card heading="Job : [[jobid]] ( [[jsondata.length]] tiles)"> 
    <template is="dom-if" if="{{jsondata}}">
        <template is="dom-repeat" items="{{jsondata}}">
            <des-thumb imtitle={{item.title}} imdisplay={{item.name}}>
            </des-thumb>
        </template>
    </template>

    <template is="dom-if" if="{{!jsondata}}">
         <h3> There are no outputs for this job. Check logfile for details.</h3>
    </template>
    </des-card>


</template>

<script>
      Polymer({
      is: "des-results",
      properties : {
        jsondata: {
            type: Array,
            },
        jobid: {
            value : '',
            type : String,
            notify: true,
        },
        jobidFull: {
            value : '',
            type : String,
            notify: true,
        },
        username:{
            type: String,
            value: '',
        },
      },
     _getTilesResponse: function() {
        if (this.jsondata.length == 0 ) {
          document.getElementById('getAllIcon').disabled=true;
           }
        else {
          document.getElementById('getAllIcon').disabled=false;
          }
	},
    });
</script>
</dom-module>
