<dom-module id="des-results-help">
<template>
    <style>
        paper-card {
        width:100%;
    --paper-card-header-color: red;
     --paper-card-background-color: var(--paper-grey-100) ;
    }
        .jobstatus {
      color: var(--color, orange);
    }
    .status {
      display: inline-block;
      box-sizing: border-box;
      width: 15px;
      height: 15px;
      border-radius: 50%;
      background: var(--paper-yellow-500);
    }
    .green {background: var(--paper-green-500);}
    .red {background: var(--paper-red-500);}
    </style>



 <paper-card heading="Help">
  <div class="card-content">
 <p> Download all tiles or a text file with the list of files only. In the latter case use:
 <pre>wget -i list.txt</pre>. Selectable list below to change between jobs</p>
    <hr style="color:black; border-color:black; background-color:black;">
    <paper-item >
    <paper-item-body>
     See the logfile
    </paper-item-body>
    <paper-icon-button icon="assignment" on-tap="_seeLog"></paper-icon-button>
    </paper-item>
 <paper-item >
    <paper-item-body>
    Download All Tiles
    </paper-item-body>
    <paper-icon-button icon="file-download" ></paper-icon-button>
    </paper-item>
    <paper-item >
    <paper-item-body>
    Get list of files
    </paper-item-body>
    <paper-icon-button icon="assignment-returned" ></paper-icon-button>
    </paper-item>
    <hr style="color:black; border-color:black; background-color:black;">
    <b> Job list shortcut</b>
               <paper-listbox id="smallJobList" >
                <template is="dom-repeat" id="menu" items="[[data]]">
                     <paper-item on-focus="_focus">
                     <template is="dom-if" if="{{_completed(item.status)}}">
                    <div class="status green" item-icon></div>
                    </template>
                     <template is="dom-if" if="{{_pending(item.status)}}">
                    <div class="status" item-icon></div>
                    </template>
                    <template is="dom-if" if="{{_stop(item.status)}}">
                    <div class="status red" item-icon></div>
                    </template>

                        <div style="font-size: 8.5px;">&nbsp; &nbsp;[[returnName(item.job)]]</div>
                    </paper-item>
            </template>
            </paper-listbox>

    </div>
</paper-card>

</template>

<script>
      Polymer({
      is: "des-results-help",
      properties: {
        data: {
            type: Array,
        },
      },
      _print: function() {
        console.log(this.data);
      },
      _focus: function(e){
        //console.log(this._returnName(e.model.item.job));
        document.getElementById("desResults").jobid=this._returnName(e.model.item.job);
        document.getElementById("desResults").jobidFull=e.model.item.job;
        document.getElementById("desLog").jobid=this._returnName(e.model.item.job);
        document.getElementById("desLog").jobidFull=e.model.item.job;
        document.getElementById("desResults").username = document.getElementById("desJobs").username;
        document.getElementById("smallJobListL").selected=e.model.index;
        document.getElementById("getTiles").generateRequest();

      },
        returnName: function(job) {
        var n1=job.search("__");
        var n2=job.search("{");
        var job0 = job.substring(n1+2,n2-1);
        return job0;
      },
        _returnName: function(job) {
        var n1=job.search("__");
        var n2=job.search("{");
        var job0 = job.substring(n1+2,n2-1);
        return job0;
      },
       _completed: function(status) {
        if (status === "SUCCESS") {return true;}
      },
      _pending: function(status) {
        if (status === "PENDING") {return true;}
      },
      _stop: function(status) {
        if (status != "PENDING" && status != "SUCCESS" ) {return true;}
      },
      _seeLog: function(){
        var jobid = document.getElementById("desResults").jobid;
        var jobidFull = document.getElementById("desResults").jobidFull;
        var pages = document.getElementById("mainPages");
        var help = document.getElementById("helpPages");
        var menu = document.querySelector('paper-menu');
        var desLog = document.getElementById("desLog");
        document.getElementById("desJobs").unselectall();
            desLog.jobidFull = jobidFull;
            desLog.jobid = jobid;
            app.selection="6";
            pages.selected="6";
            menu.selected="6";
            help.selected="6";

      },


    });


</script>
</dom-module>
